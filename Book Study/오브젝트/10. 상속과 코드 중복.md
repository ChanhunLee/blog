## 10. 상속과 코드 재사용

- 객체지향에서는 코드를 재사용하기 위해 `새로운` 코드를 추가한다. 
- 대표적인 기법인 `상속` 에 대해!
- 새로운 클래스 인스턴스 안에 기존 인스턴스를 포함시키는 `합성`

### 01 상속과 중복 코드 

#### DRY 원칙

- 중복 코드는 변경을 방해한다. 
    - 변경시 중복을 모두 찾아야 한다.
    - 찾아낸 중복을 일관되게 수정해야 한다. 
    - 중복된 코드들을 동일한 테스트 결과를 내는지 확인해야 한다.

- 중복 코드의 판단
    - 요구사항 변경시 두 코드를 함께 수정해야 한다면 중복
    - 모양이 유사하다는 것은 단지 중복의 징후

- DRY 원칙(Dont Repeat Yourself)
    - 모든 지식은 시스템 내에서 단일하고, 애매하지 않고, 정말로 믿을 만한 표현 양식을 가져야 한다. 

#### 중복과 변경

##### 중복 코드 살펴보기 
- 전화 요금 계산 애플리케이션 : 통화시간을 단위 시간단 요금으로 나눠주는 프로그램
    - Call 클래스 : 개별 통화 기간 저장
        - From 통화 시작 시간
        - To 통효 종료 시간
    - Phone 클래스 : Call 목록을 관리한다. 
        - Amount 단위요금 
        - Seconds 단위 시간
        - Calls 통화 목록
        - CalculateFee 요금 계산

- 심야 할인 요금제의 추가
    - 가장 빠른 방법은 Phone의 코드를 복사하여 NightlyDiscountPhone 을 만든 후 수정
    - RegularAmount 밤 10시 이전 통화요금
    - NightlyAmount 밤 10시 이후 통화요금

##### 중복 코드 수정하기
- 통화 요금에 부과할 세금 계산 추가 
    - Phone 클래스 수정 
        - TaxRate 세율 추가
        - CalculateFee 메서드 수정
    - NightlyDiscountPhone 클래스 수정
        - Phone과 동일하게 수정해야 한다.
    - 동일한 수정을 안하면 세금이 잘못 부과됨
- 중복 코드는 새로운 중복 코드를 부른다
- 중복 코드의 양이 많아질수록 버그는 증가하며 그에 비례해 코드 수정은 어려워진다. 

##### 타입 코드 사용하기 
- 중복 제거 방법중 하나는 클래스를 하나로 합치는 것
    - 요금제 타입 코드를 추가 하고 로직을 분기 시켜 합칠 수 있다. 
        - 하지만 타입 코드를 사용하는 클래스는 낮은 응집도와 높은 결합도를 발생

#### 상속을 이용해서 중복 코드 제거하기
- NightlyDiscountPhone가 Phone 클래스를 상속받게 만들면 코드 대부분을 재사용할 수 있다. 
    - CalculateFee를 override 하여 재정의
    - 재정의시 부모 클래스를 재사용하는 것을 고려 해야 한다. 
- 부모클래스를 사용하는 방식은 여러 가정을 필요로 하고 이것은 코드를 이해하고 어렵게 만들고 직관적이지도 않다. 
- 자식 클래스의 작성자가 부모 클래스의 구현 방법에 대한 정확한 지식을 가져야 한다는 것을 의미
- 상속은 결합도를 높인다. 

#### 강하게 결합된 Phone과 NightlyDiscountPhone
- 부모, 자식 클래스의 결합이 문제인 이유를 살펴보자








